{%- layout none -%}{%- if collection.all_products_count > 0 -%}{%- assign limit = 40 -%}{%- assign count = 0 -%}{%- paginate collection.products by 40 -%}
[{%- for product in collection.products -%}
        {%- unless count == 0 -%},{%- endunless -%}
        {{-product | json-}}        {%- assign count = count | plus: 1 -%}
        {%- if count >= 40 -%}{%- break -%}{%- endif -%}
    {%- endfor -%}]
{%- endpaginate -%}{%- else -%}[]{%- endif -%}
